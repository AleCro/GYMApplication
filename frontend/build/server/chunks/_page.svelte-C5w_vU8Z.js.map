{"version":3,"file":"_page.svelte-C5w_vU8Z.js","names":[],"sources":["../../../.svelte-kit/adapter-bun/entries/pages/app/user-management/_page.svelte.js"],"sourcesContent":["import { $ as head, a0 as escape_html, a2 as attr, a4 as ensure_array_like, a7 as attr_class, a3 as stringify, a6 as bind_props } from \"../../../../chunks/index2.js\";\nimport { p as public_env } from \"../../../../chunks/shared-server.js\";\nimport { c as cookies } from \"../../../../chunks/cookie.js\";\nimport { u as userStore, o as onDestroy } from \"../../../../chunks/stores.js\";\nlet request = (path = \"/\", method = \"GET\", body = null, headers = null) => {\n  return new Promise((resolve, reject) => {\n    let req = { method };\n    if (headers) {\n      req.headers = headers;\n    }\n    if (body) {\n      req.body = body;\n    }\n    fetch(`${public_env.PUBLIC_API_URL}${path}`, req).then((res) => res.json()).then(resolve).catch(reject);\n  });\n};\nfunction _page($$renderer, $$props) {\n  $$renderer.component(($$renderer2) => {\n    let data = $$props[\"data\"];\n    userStore.set(data?.user ?? null);\n    let unsubscribe = userStore.subscribe((value) => {\n    });\n    onDestroy(() => {\n      unsubscribe();\n    });\n    let users = data.users || [];\n    let total = data.total || 0;\n    let limit = data.limit || 10;\n    let currentPage = data.page || 1;\n    let isLoading = false;\n    let error = null;\n    let searchTerm = \"\";\n    let isSearching = false;\n    const ROLE_MAP = { 0: \"User\", 255: \"Administrator\" };\n    const getRoleName = (role) => {\n      return ROLE_MAP[role] || `Custom (${role})`;\n    };\n    async function fetchUsers(page, search = \"\") {\n      isLoading = true;\n      error = null;\n      currentPage = page;\n      try {\n        let path = `/users?limit=${limit}&page=${page}`;\n        if (search.trim()) {\n          path += `&search=${encodeURIComponent(search.trim())}`;\n        }\n        const response = await request(path, \"GET\", null, { Authorization: `Bearer ${cookies.token}` });\n        users = response.users || [];\n        total = response.total || 0;\n        limit = response.limit || 10;\n        currentPage = response.page || 1;\n      } catch (err) {\n        error = \"Failed to load users: \" + (err.message || \"Network error\");\n        console.error(err);\n      } finally {\n        isLoading = false;\n        isSearching = false;\n      }\n    }\n    data.user;\n    {\n      if (users.length === 0 && !isLoading) {\n        fetchUsers(currentPage);\n      }\n    }\n    head($$renderer2, ($$renderer3) => {\n      $$renderer3.title(($$renderer4) => {\n        $$renderer4.push(`<title>User Management</title>`);\n      });\n    });\n    $$renderer2.push(`<div class=\"space-y-6\"><header class=\"pb-4 border-b border-gray-700\"><h1 class=\"text-3xl font-bold text-white\">ðŸ‘¤ User Management</h1> <p class=\"mt-1 text-gray-400\">Manage user accounts, roles, and details. Total Users: ${escape_html(total)}</p></header> <div class=\"bg-gray-800 p-4 rounded-lg border border-gray-700\"><div class=\"flex gap-4 items-center\"><div class=\"flex-1 relative\"><div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\"><svg class=\"h-5 w-5 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"></path></svg></div> <input type=\"text\"${attr(\"value\", searchTerm)} placeholder=\"Search by username or ID...\" class=\"w-full pl-10 pr-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500\"/> `);\n    {\n      $$renderer2.push(\"<!--[!-->\");\n    }\n    $$renderer2.push(`<!--]--></div> `);\n    {\n      $$renderer2.push(\"<!--[!-->\");\n    }\n    $$renderer2.push(`<!--]--></div> `);\n    {\n      $$renderer2.push(\"<!--[!-->\");\n    }\n    $$renderer2.push(`<!--]--></div> `);\n    if (error) {\n      $$renderer2.push(\"<!--[-->\");\n      $$renderer2.push(`<div class=\"p-4 bg-red-900/30 text-red-300 rounded-lg border border-red-700 font-medium\" role=\"alert\">${escape_html(error)}</div>`);\n    } else {\n      $$renderer2.push(\"<!--[!-->\");\n    }\n    $$renderer2.push(`<!--]--> <div class=\"overflow-x-auto rounded-lg border border-gray-700 shadow-xl bg-gray-800\"><table class=\"min-w-full divide-y divide-gray-700\"><thead class=\"bg-gray-700/50\"><tr><th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider\">ID</th><th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider\">Username</th><th scope=\"col\" class=\"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider\">Role</th><th scope=\"col\" class=\"relative px-6 py-3\"><span class=\"sr-only\">Edit</span></th></tr></thead><tbody class=\"divide-y divide-gray-800\">`);\n    if (isLoading) {\n      $$renderer2.push(\"<!--[-->\");\n      $$renderer2.push(`<tr><td colspan=\"5\" class=\"px-6 py-4 text-center text-gray-500 italic\">`);\n      if (isSearching) {\n        $$renderer2.push(\"<!--[-->\");\n        $$renderer2.push(`Searching users...`);\n      } else {\n        $$renderer2.push(\"<!--[!-->\");\n        $$renderer2.push(`Loading users...`);\n      }\n      $$renderer2.push(`<!--]--></td></tr>`);\n    } else {\n      $$renderer2.push(\"<!--[!-->\");\n      if (users.length === 0) {\n        $$renderer2.push(\"<!--[-->\");\n        $$renderer2.push(`<tr><td colspan=\"5\" class=\"px-6 py-4 text-center text-gray-500 italic\">`);\n        {\n          $$renderer2.push(\"<!--[!-->\");\n          $$renderer2.push(`No users found.`);\n        }\n        $$renderer2.push(`<!--]--></td></tr>`);\n      } else {\n        $$renderer2.push(\"<!--[!-->\");\n        $$renderer2.push(`<!--[-->`);\n        const each_array = ensure_array_like(users);\n        for (let $$index = 0, $$length = each_array.length; $$index < $$length; $$index++) {\n          let user = each_array[$$index];\n          $$renderer2.push(`<tr${attr_class(`transition duration-150 ${stringify(user.id == data?.user.userID ? \"bg-gray-700 hover:bg-gray-900\" : \"hover:bg-gray-700\")}`)}><td class=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-300\">${escape_html(user?.id)}</td><td class=\"px-6 py-4 whitespace-nowrap text-sm text-white font-medium\">${escape_html(user.username)}</td><td class=\"px-6 py-4 whitespace-nowrap text-sm text-gray-400\"><span${attr_class(\"px-2 inline-flex text-xs leading-5 font-semibold rounded-full\", void 0, {\n            \"bg-indigo-600\": user.group >= 100,\n            \"bg-blue-600\": user.group < 100\n          })}>${escape_html(getRoleName(user.group))}</span></td><td class=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\"><button class=\"text-indigo-400 hover:text-indigo-300\">Edit</button></td></tr>`);\n        }\n        $$renderer2.push(`<!--]-->`);\n      }\n      $$renderer2.push(`<!--]-->`);\n    }\n    $$renderer2.push(`<!--]--></tbody></table></div> <div class=\"flex justify-between items-center pt-4\"><p class=\"text-sm text-gray-400\">Showing ${escape_html(Math.min(limit * (currentPage - 1) + 1, total))} to ${escape_html(Math.min(limit * currentPage, total))} of ${escape_html(total)} results. `);\n    {\n      $$renderer2.push(\"<!--[!-->\");\n    }\n    $$renderer2.push(`<!--]--></p> <div class=\"flex gap-2\"><button${attr(\"disabled\", currentPage === 1 || isLoading, true)}${attr_class(\"px-4 py-2 text-sm font-medium rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\", void 0, {\n      \"bg-gray-700\": currentPage !== 1,\n      \"hover:bg-gray-600\": currentPage !== 1,\n      \"text-white\": currentPage !== 1\n    })}>Previous</button> <button${attr(\"disabled\", currentPage * limit >= total || isLoading, true)}${attr_class(\"px-4 py-2 text-sm font-medium rounded-md transition disabled:opacity-50 disabled:cursor-not-allowed\", void 0, {\n      \"bg-gray-700\": currentPage * limit < total,\n      \"hover:bg-gray-600\": currentPage * limit < total,\n      \"text-white\": currentPage * limit < total\n    })}>Next</button></div></div></div> `);\n    {\n      $$renderer2.push(\"<!--[!-->\");\n    }\n    $$renderer2.push(`<!--]-->`);\n    bind_props($$props, { data });\n  });\n}\nexport {\n  _page as default\n};\n"],"mappings":"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"}