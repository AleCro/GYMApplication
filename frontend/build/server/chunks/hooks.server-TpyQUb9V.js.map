{"version":3,"file":"hooks.server-TpyQUb9V.js","names":[],"sources":["../../../.svelte-kit/adapter-bun/chunks/hooks.server.js"],"sourcesContent":["import { b as private_env } from \"./shared-server.js\";\nimport { jwtVerify } from \"jose\";\nconst SECRET = new TextEncoder().encode(private_env.JWT_SECRET.trim());\nconst handle = async ({ event, resolve }) => {\n  const token = event.cookies.get(\"token\");\n  if (token) {\n    try {\n      const { payload } = await jwtVerify(token, SECRET);\n      event.locals.user = payload;\n    } catch (err) {\n      event.locals.user = null;\n      console.warn(\"JWT validation failed:\", err.message);\n      event.cookies.delete(\"session\", { path: \"/\" });\n    }\n  } else {\n    event.locals.user = null;\n  }\n  return await resolve(event);\n};\nexport {\n  handle\n};\n"],"mappings":";;;;AAEA,MAAM,SAAS,IAAI,cAAc,OAAO,YAAY,WAAW,MAAM,CAAC;AACtE,MAAM,SAAS,OAAO,EAAE,OAAO,SAAS,KAAK;CAC3C,MAAM,QAAQ,MAAM,QAAQ,IAAI,QAAQ;AACxC,KAAI,MACF,KAAI;EACF,MAAM,EAAE,SAAS,GAAG,MAAM,UAAU,OAAO,OAAO;AAClD,QAAM,OAAO,OAAO;CACrB,SAAQ,KAAK;AACZ,QAAM,OAAO,OAAO;AACpB,UAAQ,KAAK,0BAA0B,IAAI,QAAQ;AACnD,QAAM,QAAQ,OAAO,WAAW,EAAE,MAAM,IAAK,EAAC;CAC/C;KAED,OAAM,OAAO,OAAO;AAEtB,QAAO,MAAM,QAAQ,MAAM;AAC5B"}